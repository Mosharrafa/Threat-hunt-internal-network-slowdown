# File Artifact Investigation

After confirming that a PowerShell process generated the internal network activity, the next step was to identify whether a script file existed on disk and collect evidence of execution.

Target device:
mde-test-03

---

## Step 1 — Search for PowerShell script files

```kql
DeviceFileEvents
| where Timestamp > ago(30m)
| where DeviceName == "mde-test-03"
| where FileName endswith ".ps1"
| project Timestamp, ActionType, FileName, FolderPath, InitiatingProcessFileName, InitiatingProcessCommandLine
| order by Timestamp desc
```

### Observation

Multiple PowerShell script files were created in the system temp directory:

C:\Windows\SystemTemp\_PSScriptPolicyTest_*.ps1

These files are automatically generated by PowerShell when executing scripts in memory or bypassing execution policy.

This confirmed script execution actually occurred on the host.

---

## Step 2 — Search for original script

```kql
DeviceFileEvents
| where Timestamp > ago(30m)
| where DeviceName == "mde-test-03"
| where FileName =~ "portscan.ps1"
```

### Observation

No persistent script file remained on disk.

This indicates the script was executed and then removed or not permanently stored.

---

## Step 3 — Correlate with process execution

Previously observed process command:

powershell.exe -ExecutionPolicy Bypass -File C:\programdata\portscan.ps1

This confirms the script existed at execution time but did not persist afterward.

---

## File Investigation Conclusion

The PowerShell scanning activity originated from a script executed on the endpoint.

Evidence:

• Temporary PowerShell script artifacts in SystemTemp  
• Execution policy bypass usage  
• Script execution from ProgramData  
• Script not remaining on disk afterward

This behavior matches a non-persistent script execution commonly seen in attacker reconnaissance activity.
